<app-navbar></app-navbar>

<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Bouton retour -->
    <div class="mb-6">
      <a routerLink="/stations" class="inline-flex items-center text-gray-600 hover:text-gray-900 transition">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        Retour Ã  la liste
      </a>
    </div>

    <!-- Chargement -->
    @if (isLoading) {
      <div class="flex justify-center items-center py-12">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
      </div>
    }

    <!-- Message d'erreur -->
    @if (errorMessage) {
      <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
        <p class="text-red-600">{{ errorMessage }}</p>
      </div>
    }

    <!-- DÃ©tails de la station -->
    @if (!isLoading && station) {
      <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
        <!-- Header -->
        <div class="bg-gradient-to-r from-primary to-primary-dark p-8 text-white">
          <div class="flex justify-between items-start">
            <div>
              <h1 class="text-3xl font-bold mb-2">{{ station.name }}</h1>
              <p class="text-green-100">
                {{ station.address.street }}, {{ station.address.postalCode }} {{ station.address.city }}
              </p>
            </div>
            <span [ngClass]="'px-4 py-2 rounded-full text-sm font-semibold ' + (station.available ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800')">
              {{ station.available ? 'Disponible' : 'OccupÃ©e' }}
            </span>
          </div>
        </div>

        <!-- Contenu principal -->
        <div class="p-8">
          <div class="grid md:grid-cols-2 gap-8">
            <!-- Colonne gauche : CaractÃ©ristiques -->
            <div>
              <h2 class="text-2xl font-bold text-gray-900 mb-6">CaractÃ©ristiques</h2>
              
              <div class="space-y-4">
                <!-- Puissance -->
                <div class="flex items-start">
                  <div class="flex-shrink-0 w-12 h-12 bg-primary-light rounded-lg flex items-center justify-center">
                    <span class="text-2xl">âš¡</span>
                  </div>
                  <div class="ml-4">
                    <p class="text-sm text-gray-500">Puissance</p>
                    <p class="text-lg font-semibold text-gray-900">{{ station.chargingPower || station.chargingPowerKw + ' kW' }}</p>
                  </div>
                </div>

                <!-- Prix -->
                <div class="flex items-start">
                  <div class="flex-shrink-0 w-12 h-12 bg-primary-light rounded-lg flex items-center justify-center">
                    <span class="text-2xl">ðŸ’°</span>
                  </div>
                  <div class="ml-4">
                    <p class="text-sm text-gray-500">Tarif horaire</p>
                    <p class="text-lg font-semibold text-primary">{{ station.hourlyPrice }}â‚¬ / heure</p>
                  </div>
                </div>

                <!-- Support -->
                @if (station.hasStand !== undefined) {
                  <div class="flex items-start">
                    <div class="flex-shrink-0 w-12 h-12 bg-primary-light rounded-lg flex items-center justify-center">
                      <span class="text-2xl">ðŸ”Œ</span>
                    </div>
                    <div class="ml-4">
                      <p class="text-sm text-gray-500">Support</p>
                      <p class="text-lg font-semibold text-gray-900">{{ station.hasStand ? 'Avec support' : 'Sans support' }}</p>
                    </div>
                  </div>
                }

                <!-- PropriÃ©taire -->
                @if (station.owner) {
                  <div class="flex items-start">
                    <div class="flex-shrink-0 w-12 h-12 bg-primary-light rounded-lg flex items-center justify-center">
                      <span class="text-2xl">ðŸ‘¤</span>
                    </div>
                    <div class="ml-4">
                      <p class="text-sm text-gray-500">PropriÃ©taire</p>
                      <p class="text-lg font-semibold text-gray-900">
                        {{ station.owner.firstName }} {{ station.owner.lastName }}
                      </p>
                    </div>
                  </div>
                }
              </div>
            </div>

            <!-- Colonne droite : Localisation -->
            <div>
              <h2 class="text-2xl font-bold text-gray-900 mb-6">Localisation</h2>
              
              <!-- Map placeholder -->
              <div class="bg-gray-200 rounded-lg h-64 mb-6 flex items-center justify-center">
                <div class="text-center">
                  <svg class="w-16 h-16 mx-auto text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                  </svg>
                  <p class="text-gray-600">Latitude: {{ station.location.latitude }}</p>
                  <p class="text-gray-600">Longitude: {{ station.location.longitude }}</p>
                </div>
              </div>

              <!-- Instructions -->
              @if (station.instruction) {
                <div>
                  <h3 class="text-lg font-semibold text-gray-900 mb-3">Instructions d'accÃ¨s</h3>
                  <p class="text-gray-600 leading-relaxed">{{ station.instruction }}</p>
                </div>
              }
            </div>
          </div>

          <!-- Actions -->
          <div class="mt-8 pt-8 border-t border-gray-200">
            <div class="flex flex-wrap gap-4">
              <!-- Bouton rÃ©server -->
              @if (station.available) {
                <a [routerLink]="['/bookings/new', station.id]" class="flex-1 px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark transition font-semibold text-center">
                  ðŸ’³ RÃ©server cette borne
                </a>
              } @else {
                <button disabled class="flex-1 px-6 py-3 bg-gray-300 text-gray-500 rounded-lg cursor-not-allowed font-semibold">
                  Borne non disponible
                </button>
              }

              <!-- Boutons propriÃ©taire -->
              @if (canEdit()) {
                <a [routerLink]="['/stations', station.id, 'edit']" class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition font-semibold">
                  Modifier
                </a>
                <button (click)="deleteStation()" class="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition font-semibold">
                  Supprimer
                </button>
              }
            </div>
          </div>
        </div>
      </div>

      <!-- Informations supplÃ©mentaires -->
      <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
        <div class="flex">
          <svg class="w-6 h-6 text-blue-600 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <div>
            <h3 class="text-sm font-semibold text-blue-900 mb-1">Informations pratiques</h3>
            <p class="text-sm text-blue-800">
              Le paiement se fait directement sur la plateforme. 
              Pensez Ã  vÃ©rifier la compatibilitÃ© de votre vÃ©hicule avec le type de borne avant de rÃ©server.
            </p>
          </div>
        </div>
      </div>
    }
  </div>
</div>